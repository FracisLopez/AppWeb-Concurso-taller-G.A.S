<!doctype html>
<html lang="en">

<head>


  <!--   include('Css')-->

  <!-- Bootstrap CSS -->

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <!-- DataTable -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap4.min.css">

  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.3.0/css/responsive.bootstrap4.min.css">


  <!-- Los iconos tipo Solid de Fontawesome-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/solid.css">
  <script src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>

  <!--JQUERY-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <style>
 
  </style>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Concurso Taller</title>
</head>

<body id="body_fondo">

  <!-- include('Menu')-->

  <nav class="navbar navbar-expand-lg navbar-dark rounded shadow" id="menu" style="background-color: #0047AB;" hidden>
    <a class="navbar-brand" href="#"></a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav" style="background-color:#3366CC;border-radius:5px;">
        <li class="nav-item active" id="li_dashboard">
          <a class="nav-link" href="#" onclick="menuPagina2()"> Dashboard <i
                            class='fas fa-tachometer-alt'></i><span class="sr-only">(current)</span></a>
        </li>

        <li class="nav-item" id="li_registrar">
          <a class="nav-link" href="#" onclick="menuPagina3()"> Registrar Vehículo <i
                            class='fa fa-car'></i></a>
        </li>              
        <li class="nav-item" id="li_configuracion">
          <a class="nav-link" href="#" onclick="menuPagina4()"> Configuracion <i class='fab fa-whmcs'></i></a>
        </li>
        <!-- <li class="nav-item">
        <a class="nav-link" href="#" id="li_tutorial" > Tutorial <i class="fab fa-youtube"></i></a>
      </li>
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
          Dropdown link
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="#"> Action</a>
          <a class="dropdown-item" href="#"> Another action</a>
          <a class="dropdown-item" href="#"> Something else here</a>
        </div>
      </li> -->
      </ul>
    </div>

    <a class="nav-link" href="#" style="color:#FFFFFF" id="nombre_sesion"></a>

  </nav>

  <!-- Quito la clase container-->
  <div class="">
    <br>

    <!--    include('Login') -->

    <div class="modal-dialog text-center col-xs-12 col-sm-6 col-md-8" id="login">
      <div class="col-md-8 main-section">
        <div class="modal-content">
          <form class="col-12" th:action="" method="">
            <br>
            <h2 id="titulo"><i class="fas fa-trophy winner-icon" id="logo" aria-hidden="true"></i> Concurso
            </h2>
            <p id="descripcion" class="frase-incentivo">Talleres ejemplo Taller</p>

            <div class="form-group letra" id="user-group">
              <input type="text" class="form-control" style="background-color: #cff0fc"
                                placeholder="usuario" name="usuario" id="txt_usuario" />
            </div>
            <div class="form-group letra" id="contrasena-group">
              <input type="password" class="form-control" style="background-color: #cff0fc"
                                placeholder="Contrasena" name="password" id="txt_password" />
            </div>
            <div class="form-group">
              <label for="rol">Rol:</label><br>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="rol" id="rolUsuario" value="Usuario"
                                    checked>
                <label class="form-check-label" for="rolUsuario">Usuario</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="rol" id="rolAdministrador"
                                    value="Administrador">
                <label class="form-check-label" for="rolAdministrador">Administrador</label>
              </div>
            </div>

            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" id="openModalBtn" onclick="valirdarLogin()"><i
                                class="fa fa-rocket" aria-hidden="true"></i> Ingresar</button>
          </form><!-- Fin For -->
        </div><!-- Fin modal-content -->
      </div><!-- col-md-8 main-section -->
    </div><!-- Fin login -->

    <!--     include('Pagina2')-->

    <div class="row">
      <div class="col-xl-11 col-md-11 col-sm-11 card shadow p-3 mb-5 bg-white rounded container card-margen"
        id="pagina2" style="visibility:hidden;background:#FFFFFF">

        <!--  <div class="card shadow p-3 mb-5 bg-white rounded container card-margen" style="background:#FFFFFF">-->
        <!--<div class="card-body">-->

        <div class="row alert alert-warning" role="alert" style="margin: 5px 5px;">
          <div class="col-xl-5 col-md-5 col-sm-5">

            <h5 class="modal-title"
              style="font-size: 20px; font-weight: bold; color: #333; text-transform: uppercase; margin: 20px 0;">
              Resultado del Concurso <span class="badge" id="spanAbiertoCerrado"></span></h5>

          </div>

          <div class="col-xl-4 col-md-4 col-sm-4">
            <figure style="margin: 20px 0;">
              <blockquote class="blockquote"></blockquote>
              <figcaption class="blockquote-footer">
                Nota <cite title="Source Title" id="citeFechahora"></cite>

              </figcaption>
            </figure>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <button type="button" class="btn btn-warning" style="margin: 20px 0;"
                            onclick="dashBtnActualizar()" id="btnDashActualizar">Actualizar</button>

          </div>


        </div>
        <!--fin row titulo Ranking-->

        <div class="row" style="margin: 5px 5px;">

          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 p-2">
            <div class="card rounded shadow text-white" style="background:#0047AB">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-chart-line fa-3x mr-3"></i>
                <div>
                  <h6 class="card-title">Objetivo</h6>
                  <h4 class="card-subtitle mb-2 text-white" id="h4obejtivos">-</h4>
                </div>
              </div>
            </div>
          </div>

          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 p-2">
            <div class="card rounded shadow text-white" style="background:#0047AB">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-car fa-3x mr-3"></i>
                <div>
                  <h6 class="card-title">Piezas</h6>
                  <h4 class="card-subtitle mb-2 text-white" id="h4ventas">-</h4>
                </div>
              </div>
            </div>
          </div>

          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 p-2">
            <div class="card rounded shadow  text-white" style="background:#0047AB">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-tachometer-alt fa-3x mr-3"></i>
                <div>
                  <h6 class="card-title">Gap</h6>
                  <h4 class="card-subtitle mb-2 text-white" id="h4gap">-</h4>

                </div>
              </div>
            </div>
          </div>


        </div>
        <!--fin row Card-->

        <div class="row" style="margin: 5px 5px;">

          <div class="col-xl-12 col-lg-12 col-md-12  col-sm-12 p-2">
            <div class="progress" style="height: 35px;">
              <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 0.5%"
                aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" id="progressAvance">
                <h5 id="h5avance">-</h5>
              </div>
            </div>
          </div>
        </div>
        <!--Row Fin barra de progreso -->

        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-12 col-md-12 col-sm-12">

            <h6 class="modal-title"
              style="font-size: 20px; font-weight: bold; color: #333; text-transform: uppercase; margin: 20px 0;">
              Ranking de Posiciones</h6>
          </div>
        </div>
        <!--fin row titulo Ranking-->


        <div class="row containerCopa" style="margin: 5px 5px;">

          <div class="col-xl-12 col-lg-12 col-md-12  col-sm-12 p-2 text-center">
            </br>
            <i class="fas fa-trophy winner-icon-cargando fa-3x mr-3" id="logo" aria-hidden="true"></i>
            <p class="frase-incentivo" id="pprimer" style="color:#000000"></p>

          </div>


        </div>
        <!--Row Primer puesto-->


        <div class="row containerCopa" style="margin: 5px 5px;">

          <div class="col-xl-16 col-lg-6 col-md-6  col-sm-6 p-2 text-center">
            </br>
            <i class="fas fa-trophy winner-icon-segundo fa-3x mr-3" style="color:#C0C0C0" id="logo"
                            aria-hidden="true"></i>
            <p class="frase-incentivo" id="psegundo" style="color:#000000"></p>

          </div>

          <div class="col-xl-6 col-lg-6 col-md-6  col-sm-6 p-2 text-center">
            </br>
            <i class="fas fa-trophy winner-icon-segundo fa-3x mr-3" id="logo" style="color:#CD7F32"
                            aria-hidden="true"></i>
            <p class="frase-incentivo" id="ptercero" style="color:#000000"></p>

          </div>



        </div>
        <!--Row Sefgungo y tercero puesto-->


        <div class="row" style="margin: 5px 5px;">

          <div class="col-xl-12 col-lg-12 col-md-12  col-sm-12 p-2 text-center">

            <table class="shadow " id="tableRanking">
              <thead>
                <tr>
                  <th>Puesto</th>
                  <th>Nombre</th>
                  <th>Piezas</th>
                </tr>
              </thead>
              <tbody>

              </tbody>
            </table>

          </div>
        </div>
        <!--Row tabla-->
        <!-- </div>col-xl-12 col-md-12-->
        <!-- </div>col-xl-12 col-md-12-->

      </div>
      <!--col-xl-12 col-md-12-->
    </div>
    <!--fin row-->

    <!--     include('Pagina3') -->

    <div class="row">
      <div class="col-xl-11 col-md-11 col-sm-11 card shadow p-3 mb-5 bg-white rounded container card-margen"
        id="pagina3" style="visibility:hidden;background:#FFFFFF">

        <!--    <div class="card shadow p-3 mb-5 bg-white rounded container card-margen" style="background:#FFFFFF">-->
        <!--    <div class="card-body">-->

        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-8 col-md-8 col-sm-8">
            <h5 class="modal-title"
              style="font-size: 20px; font-weight: bold; color: #333; text-transform: uppercase; margin: 20px 10px;">
              Registro de Vehículos
              <a href="#" onclick="exportarTablaAExcel()" title="Exportar a Excel">
                <i class="far fa-file-excel fa-lg" style="color:#99CCFF"></i>
              </a>
            </h5>
          </div>
          <div class="col-xl-2 col-md-2 col-sm-2 ml-auto">
            <button type="button" class="btn btn-primary" id="btnNuevo" data-toggle="modal"
                            data-target="#myModalVentas" onclick="abrirmodalVenta()"><i class='fas fa-plus-square'></i>
                            Agregar</button>
          </div>
          <div class="col-xl-2 col-md-2 col-sm-2 ml-auto">
            <button type="button" class="btn btn-danger" onclick="listaVentas()"><i
                                class='fas fa-search'></i>Consultar</button>
          </div>

        </div><!-- Fin Row -->

        <!-- Modal -->
        <div class="modal fade" id="myModalVentas" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true" data-keyboard="false" data-backdrop="static">
          <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
              <div class="modal-header p-4">
                <h5 class="modal-title" id="myModalLabel">Registar</h5>
                <div class="ml-auto">
                  <button type="button" class="close" data-dismiss="modal" onclick="">
                    <i class="fas fa-window-close"></i>
                  </button>
                </div>
              </div>

              <!-- Inicio Contenido Modal -->
              <div class="modal-body">
                <input type="text" id="txt_nombreSesion" class="form-control" style="display:none"
                 disabled>
                <div class="row">
                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="codigo">Key</label>
                      <input type="text" id="txtkey" class="form-control" placeholder="Automático"
                        disabled>
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Matrícula</label>
                      <input type="text" class="form-control text-uppercase" id="txtMatricula">
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Vehículo</label>
                      <input type="text" class="form-control text-uppercase" id="txtVehiculo">
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Modelo</label>
                      <input type="text" class="form-control text-uppercase" id="txtModelo">
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Año</label>
                      <input type="text" class="form-control text-uppercase" id="txtAnio">
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Color</label>
                      <input type="text" class="form-control text-uppercase" id="txtColor">
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Compañía</label>
                      <select id="select_productoServicio" class="form-control"></select>
                    </div>
                  </div>

                  <div class="col-lg-3">
                    <div class="d-flex flex-column">
                      <label for="ndocumento">Piezas</label>
                      <input type="number" min="0" step="1" class="form-control"id="numberPiezas">
                    </div>
                  </div>
                </div>
              </div><!-- Fin Contenido Modal -->

              <!--Inicio Footer -->
              <div class="modal-footer d-flex">
                <div class="flex-fill mx-1">
                  <button type="button" id="btnCerrarModal" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                </div>
                <div class="flex-fill mx-1">
                  <button type="button" id="btnGuardarPiezas" class="btn btn-primary" onclick="antesdeAgregarAbiertoCerrado()">Guardar</button>
                </div>
              </div>
              <!--Fin Footer -->
            </div>
          </div>
        </div><!-- fin Modal -->


        <!--div cargando-->
        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-12 col-md-12 col-sm-12">
            <div class="progress" id="divcargandoconsulta" style="display:none">
              <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75"
                aria-valuemin="0" aria-valuemax="100" style="width: 75%">CARGANDO ...
              </div>
            </div>
          </div>
        </div>
        <!--Fin div Cargando row-->


        <!-- Lista  table-->
        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12" id="div_datatable">
            <table id="registrosTable" class="table table-striped table-sm table-hover table-bordered dt-responsive"
              style="width:100%">
            </table>

          </div><!-- Lista Table fin cols12  -->
        </div>
        <!-- Fin Lista tabble-->



        <!--</div>col-xl-12 col-md-12-->
        <!-- </div>col-xl-12 col-md-12-->

      </div>
      <!--col-xl-12 col-md-12-->
    </div>
    <!--fin row-->

    <!--     include('Pagina4') -->

    <div class="row">
      <div class="col-xl-11 col-md-11 col-sm-11 card shadow p-3 mb-5 bg-white rounded container card-margen"
        id="pagina4" style="visibility:hidden;background:#FFFFFF;">

        <!--<div class="card shadow p-3 mb-5 bg-white rounded container card-margen" style="background:#FFFFFF">-->
        <!--<div class="card-body">-->

        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-3 col-md-3 col-sm-3">
            <h5 class="modal-title"
              style="font-size: 20px; font-weight: bold; color: #333; text-transform: uppercase; margin: 20px 10px;">
              Configuración
            </h5>

          </div>

          <div class="col-xl-9 col-md-9 col-sm-9 custom-control custom-switch" style="margin: 20px 0;">
            <input type="checkbox" class="custom-control-input" value="" id="chkAbrirCerrar"
                            onclick="abrircerrarConcurso()">
            <label class="custom-control-label" for="chkAbrirCerrar" id="labelAbrirCerrar"></label>
          </div>


        </div><!-- Fin Row -->


        <div class="row" style="margin: 5px 5px;">

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Fecha Inicio</label>
              <input type="date" class="form-control" id="txtConFechaini" name="fechaini">
            </div>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Hora Inicio</label>
              <input type="time" class="form-control" id="timeHoraini">
            </div>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Fecha Fin</label>
              <input type="date" class="form-control" id="txtConFechafin">
            </div>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Hora Fin</label>
              <input type="time" class="form-control" id="timeHorafin">
            </div>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Objetivo</label>
              <input type="text" class="form-control" id="txtobjetivo">
            </div>
          </div>

          <div class="col-xl-2 col-md-2 col-sm-2">
            <div class="d-flex flex-column">
              <label for="fechaNacimiento">Accion</label>
              <div class="form-inline" style="margin: 20px 0">
                <div class="form-check mr-3">
                  <input class="form-check-input" type="radio" name="radioConfig" id="radioGuardar"
                                        value="Guardar" onclick="guardarFechaHora()">
                  <label class="form-check-label" for="radioId1">Guardar</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="radioConfig" id="radioEditar"
                                        value="Editar" checked onclick="editarFechaHora()">
                  <label class="form-check-label" for="radioId2">Editar</label>
                </div>
              </div>
            </div>
          </div>
        </div><!-- Fin Row -->

        <div class="row" style="margin: 5px 5px;">

          <div class="col-12 col-xl-8 col-lg-8 col-md-8 col-sm-8">
            <input type="text" class="form-control text-uppercase" placeholder="Escribe Compañia Aseguradora"
                            id="txtconfig">
          </div>

          <div class="col-12 col-xl-2 col-lg-3 col-md-2 col-sm-2">
            <button type="button" class="btn btn-primary" id="btnconfigAgregar"
                            onclick="configAgregar()">Agregar</button>
          </div>
          <div class="col-12 col-xl-2 col-lg-2 col-md-2 col-sm-2">
            <button type="button" class="btn btn-secondary" id="btnconfigEliminar"
                            onclick="configEliminarFila()">Eliminar</button>
          </div>

        </div><!-- fin text y button ROW-->


        <!-- CARGANDO -->
        <div class="row" style="margin: 5px 5px;">
          <div class="col-xl-12 col-md-12 col-sm-12">
            <div class="progress" id="divcargando" style="display:none">
              <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75"
                aria-valuemin="0" aria-valuemax="100" style="width: 75%">UN
                MOMENTO,CARGANDO ... </div>

            </div>
          </div>
          </br>
        </div>
        <!--row-->

        <div class="row" style="margin: 5px 5px;">

          <div class="col-12 col-sm-12 col-md-12 col-lg-12">
            <select class="custom-select" size="10" id="seleElementos">
                        </select>
          </div>


        </div><!-- fin select de items-->



        <!--</div>col-xl-12 col-md-12-->
        <!-- </div>col-xl-12 col-md-12-->

      </div>
      <!--col-xl-12 col-md-12-->
    </div>
    <!--fin row-->

  </div><!-- Fin Container container -->


  <!--     include('Js') -->



  <script>
    window.addEventListener('load', function () {

            //alert('probanddo');
            console.log('JS Cargdo');
            document.getElementById('pagina2').style.position = "absolute";
            document.getElementById('pagina3').style.position = "absolute";
            document.getElementById('pagina4').style.position = "absolute";



        });


        // *************CLICK EN OPCIONES DE MENU**************
        // ***********************************

        function menuPagina2() {

            // Agregra y Quita una clase
            document.getElementById('pagina2').style.visibility = 'visible';
            document.getElementById('pagina3').style.visibility = 'hidden';
            document.getElementById('pagina4').style.visibility = 'hidden';

            document.getElementById('pagina2').style.position = "relative";
            document.getElementById('pagina3').style.position = "absolute";
            document.getElementById('pagina4').style.position = "absolute";


            document.getElementById('li_dashboard').classList.add('active');
            document.getElementById('li_registrar').classList.remove('active');
            document.getElementById('li_configuracion').classList.remove('active');




        }// Opcion menuPagina2

        function menuPagina3() {

            // Agregra y Quita una clase
            document.getElementById('pagina3').style.visibility = 'visible';
            document.getElementById('pagina2').style.visibility = 'hidden';
            document.getElementById('pagina4').style.visibility = 'hidden';

            document.getElementById('pagina3').style.position = "relative";
            document.getElementById('pagina2').style.position = "absolute";
            document.getElementById('pagina4').style.position = "absolute";


            document.getElementById('li_registrar').classList.add('active');
            document.getElementById('li_dashboard').classList.remove('active');
            document.getElementById('li_configuracion').classList.remove('active');


        }// Opcion menuPagina3

        function menuPagina4() {

            // Agregra y Quita una clase
            document.getElementById('pagina4').style.visibility = 'visible';
            document.getElementById('pagina2').style.visibility = 'hidden';
            document.getElementById('pagina3').style.visibility = 'hidden';

            document.getElementById('pagina4').style.position = "relative";
            document.getElementById('pagina3').style.position = "absolute";
            document.getElementById('pagina2').style.position = "absolute";


            document.getElementById('li_configuracion').classList.add('active');
            document.getElementById('li_registrar').classList.remove('active');
            document.getElementById('li_dashboard').classList.remove('active');


        }// Opcion menuPagina4


        // *************FIN  CLICK EN OPCIONES DE MENU**************
        // ***********************************




        function valirdarLogin() {

            var openModalBtn = document.getElementById('openModalBtn');
            openModalBtn.disabled = true;

            var rol = document.querySelector('input[name="rol"]:checked').value;

            google.script.run
                .withSuccessHandler(rptVerificarPasswordLogin)
                .withFailureHandler(muestraError)
                .verificarPasswordLogin(document.getElementById("txt_usuario").value, document.getElementById("txt_password").value, rol);

        }

        function rptVerificarPasswordLogin(resultado) {



            var openModalBtn = document.getElementById('openModalBtn');

            switch (resultado[0]) {
                case 'LoginOk':
                    //alertcargando();
                    if (resultado[1] == 'Usuario') {

                        //alert('Inicio Usuario');
                        document.getElementById('li_configuracion').style.visibility = 'hidden';
                        //document.getElementById('li_tutorial').style.visibility='hidden';



                        muestraPagina2(resultado[2]);


                    }// Fin if Usuario

                    if (resultado[1] == 'Administrador') {

                        //alert('Inicio Administrador')

                        muestraPagina2(resultado[2]);



                    }// Fin if Administrador

                    var openModalBtn = document.getElementById('openModalBtn');
                    openModalBtn.disabled = false;
                    break;

                case 'LoginIncorrecto':
                    // alert('incorrecto jeje');
                    //alertErrorSesion();
                    muestraError();
                    var openModalBtn = document.getElementById('openModalBtn');
                    openModalBtn.disabled = false;
                    document.getElementById("txt_password").value = "";
                    document.getElementById("txt_usuario").value = "";
                    break;

            }


        }//rptVerificarPasswordLogin



        function muestraPagina2(inicio_sesion) {

            //alertcargando();

            leerAbrircerrarConcurso();
            leerFechaHora();
            configobtenerFilas();
            cargarselect();
            dashleerFechaHoravigencia();
            dashrankingVentas();
            dashtotales();
            var loginpage = document.getElementById('login');
            loginpage.hidden = true;

            var menu = document.getElementById('menu');
            menu.hidden = false;

            //var pagina2=document.getElementById('pagina2');
            //pagina2.hidden=false;

            document.getElementById('pagina2').style.visibility = 'visible';

            var body_fondo = document.getElementById('body_fondo');
            body_fondo.style.backgroundColor = '#f1f1f1';

            var nombre_sesion = document.getElementById('nombre_sesion');
            nombre_sesion.innerHTML = 'Bienvenido: ' + inicio_sesion;

            var txt_nombreSesion = document.getElementById('txt_nombreSesion');
            txt_nombreSesion.value = inicio_sesion;

            //var divTabla = document.getElementById('divTabla');
            //divTabla.style.display ='none';

            menuPagina2();


        }


        function abrircerrarConcurso() {

            var chkAbrirCerrar = document.getElementById("chkAbrirCerrar");
            var labelAbrirCerrar = document.getElementById("labelAbrirCerrar");
            var spanAbiertoCerrado = document.getElementById("spanAbiertoCerrado");
            var valor

            if (chkAbrirCerrar.checked) {
                labelAbrirCerrar.textContent = "Concurso Cerrado";
                //spanAbiertoCerrado.textContent = "Cerrado";
                //document.getElementById('spanAbiertoCerrado').classList.remove('badge-primary');
                //document.getElementById('spanAbiertoCerrado').classList.add('badge-danger');
                valor = 0;
            } else {
                labelAbrirCerrar.textContent = "Concurso Abierto";
                //spanAbiertoCerrado.textContent = "Abierto";
                //document.getElementById('spanAbiertoCerrado').classList.remove('badge-danger');
                //document.getElementById('spanAbiertoCerrado').classList.add('badge-primary');
                valor = 1;
            }



            google.script.run
                .withSuccessHandler(rptAbrircerrarConcurso)
                .withFailureHandler(muestraErrorProceso)
                .gsagregarAbrircerrarConcurso(valor);

        }//abrircerrarConcurso

        function rptAbrircerrarConcurso(valor) {

            console.log(valor);

        }//rptAbrircerrarConcurso




        function leerAbrircerrarConcurso() {

            google.script.run
                .withSuccessHandler(rptLeerAbrircerrarConcurso)
                .withFailureHandler(muestraErrorProceso)
                .gsleerAbrircerrarConcurso();


        }//leerAbrircerrarConcurso

        function rptLeerAbrircerrarConcurso(valor) {

            var spanAbiertoCerrado = document.getElementById("spanAbiertoCerrado");
            var chkAbrirCerrar = document.getElementById("chkAbrirCerrar");
            var labelAbrirCerrar = document.getElementById("labelAbrirCerrar");

            if (valor == 1) {// Abierto

                spanAbiertoCerrado.textContent = "Abierto";
                document.getElementById('spanAbiertoCerrado').classList.remove('badge-danger');
                document.getElementById('spanAbiertoCerrado').classList.add('badge-primary');
                chkAbrirCerrar.checked = false;
                labelAbrirCerrar.textContent = "Concurso Abierto";

            } else {// Cerrado
                spanAbiertoCerrado.textContent = "Cerrado";
                document.getElementById('spanAbiertoCerrado').classList.remove('badge-primary');
                document.getElementById('spanAbiertoCerrado').classList.add('badge-danger');
                chkAbrirCerrar.checked = true;
                labelAbrirCerrar.textContent = "Concurso Cerrado";

            }

        }//rptLeerAbrircerrarConcurso

        function guardarFechaHora() {


            var txtConFechaini = document.getElementById("txtConFechaini");
            var timeHoraini = document.getElementById("timeHoraini");
            var txtConFechafin = document.getElementById("txtConFechafin");
            var timeHorafin = document.getElementById("timeHorafin");
            var txtobjetivo = document.getElementById("txtobjetivo");

            txtConFechaini.disabled = true;
            timeHoraini.disabled = true;
            txtConFechafin.disabled = true;
            timeHorafin.disabled = true;
            txtobjetivo.disabled = true;

            google.script.run
                .withSuccessHandler(rptGuardarFechaHora)
                .withFailureHandler(muestraErrorProceso)
                .gsGuardarFechaHora(txtConFechaini.value, timeHoraini.value, txtConFechafin.value, timeHorafin.value, txtobjetivo.value);



        }//guardarFechaHora

        function rptGuardarFechaHora(valor) {

            console.log(valor);

        }//guardarFechaHora

        function editarFechaHora() {


            var txtConFechaini = document.getElementById("txtConFechaini");
            var timeHoraini = document.getElementById("timeHoraini");
            var txtConFechafin = document.getElementById("txtConFechafin");
            var timeHorafin = document.getElementById("timeHorafin");
            var txtobjetivo = document.getElementById("txtobjetivo");

            txtConFechaini.disabled = false;
            timeHoraini.disabled = false;
            txtConFechafin.disabled = false;
            timeHorafin.disabled = false;
            txtobjetivo.disabled = false;

        }//editarFechaHora

        function leerFechaHora() {

            google.script.run
                .withSuccessHandler(rpt_leerFechahora)
                .withFailureHandler(muestraErrorProceso)
                .gsleerFechaHora();



        }// fin leer fecha hora

        function rpt_leerFechahora(resultado) {

            var txtConFechaini = document.getElementById("txtConFechaini");
            var timeHoraini = document.getElementById("timeHoraini");
            var txtConFechafin = document.getElementById("txtConFechafin");
            var timeHorafin = document.getElementById("timeHorafin");
            var txtobjetivo = document.getElementById("txtobjetivo");
            var radioGuardar = document.getElementById('radioGuardar');

            txtConFechaini.disabled = true;
            timeHoraini.disabled = true;
            txtConFechafin.disabled = true;
            timeHorafin.disabled = true;
            txtobjetivo.disabled = true;
            radioGuardar.checked = true;

            txtConFechaini.value = resultado[0];
            timeHoraini.value = resultado[1];
            txtConFechafin.value = resultado[2];
            timeHorafin.value = resultado[3];
            txtobjetivo.value = resultado[4];


        }// rpt_leerFechahora

        function configAgregar() {



            if (document.getElementById('txtconfig').value != "") {

                var btnconfigAgregar = document.getElementById('btnconfigAgregar');
                btnconfigAgregar.disabled = true;

                var btnconfigEliminar = document.getElementById('btnconfigEliminar');
                btnconfigEliminar.disabled = true;

                var txtconfig = document.getElementById('txtconfig').value;
                var control = "select_productoServicio";
                var datos = [control, txtconfig.toUpperCase()];

                google.script.run
                    .withSuccessHandler(rpt_configAgregar)
                    .withFailureHandler(muestraErrorProceso)
                    .gsconfigAgregar(datos);

            } else {

                Swal.fire('No se puede agregar, por favor escribe en la caja de texto')

            }

        }// Fin configAgregar

        function rpt_configAgregar() {

            document.getElementById('txtconfig').value = "";
            alertRegistro();
            configobtenerFilas();
            //cargarselect();

            var btnconfigAgregar = document.getElementById('btnconfigAgregar');
            btnconfigAgregar.disabled = false;

            var btnconfigEliminar = document.getElementById('btnconfigEliminar');
            btnconfigEliminar.disabled = false;


        }// fin rpt_ConfigAgregar




        function configobtenerFilas() {

            var divcargando = document.getElementById('divcargando');
            divcargando.style.display = '';

            var filtro = "select_productoServicio";

            google.script.run
                .withSuccessHandler(rpt_configobtenerFilas)
                .withFailureHandler(muestraErrorProceso)
                .gsConfigobtenerFilas(filtro);

        }// configuracionAgregar()

        function rpt_configobtenerFilas(filasFiltradas) {

            var selectElemento = document.getElementById("seleElementos");

            // Limpiar opciones existentes
            selectElemento.innerHTML = "";

            var optvacioelementos = document.createElement("option");
            optvacioelementos.value = "";
            optvacioelementos.text = "-- Seleccionar ▼ --";
            optvacioelementos.selected = false;
            optvacioelementos.disabled = true;
            selectElemento.appendChild(optvacioelementos);

            // Agregar opciones filtradas al select
            for (var j = 0; j < filasFiltradas.length; j++) {
                var option = document.createElement("option");
                option.value = filasFiltradas[j][1]; // Valor de la columna B
                option.text = filasFiltradas[j][1]; // Texto de la columna B
                selectElemento.appendChild(option);
            }

            var divcargando = document.getElementById('divcargando');
            divcargando.style.display = 'none';

        }// rpt_configobtenerFilas


        function configEliminarFila() {

            var btnconfigAgregar = document.getElementById('btnconfigAgregar');
            btnconfigAgregar.disabled = true;

            var btnconfigEliminar = document.getElementById('btnconfigEliminar');
            btnconfigEliminar.disabled = true;

            var selectElemento = document.getElementById("seleElementos");
            var filaSeleccionada = selectElemento.value;

            if (filaSeleccionada == "") {

                Swal.fire('No se puede eliminar, por favor selecciona un elemento de la lista.')
                btnconfigAgregar.disabled = false;
                btnconfigEliminar.disabled = false;

            } else {
                Swal.fire({
                    position: 'top',
                    title: 'Deseas eliminar este registro?',
                    text: "Estas seguro?'",
                    icon: 'error',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, Eliminarlo!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        google.script.run
                            .withSuccessHandler(rpt_configEliminarFila)
                            .withFailureHandler(muestraErrorProceso)
                            .gsConfigEliminarFila(filaSeleccionada);

                        Swal.fire(
                            {
                                position: 'top',
                                title: 'Eliminado!',
                                text: 'El registro ha sido Eliminado.',
                                icon: 'success'
                            }
                        )
                    }
                    btnconfigAgregar.disabled = false;
                    btnconfigEliminar.disabled = false;
                })

            }// Fin else

        } // Fin eliminar registro

        function rpt_configEliminarFila() {

            configobtenerFilas();
            //cargarselect();

            var btnconfigAgregar = document.getElementById('btnconfigAgregar');
            btnconfigAgregar.disabled = false;

            var btnconfigEliminar = document.getElementById('btnconfigEliminar');
            btnconfigEliminar.disabled = false;

        }

        function cargarselect() {

            google.script.run
                .withSuccessHandler(rpt_Cargarselect)
                .withFailureHandler(muestraErrorProceso)
                .gsCargarSelect();

        }// configuracionAgregar()

        function rpt_Cargarselect(data) {

            var select_productoServicio = document.getElementById("select_productoServicio");
            // Limpiar opciones existentes
            select_productoServicio.innerHTML = "";

            var optvacioproductoServicio = document.createElement("option");
            optvacioproductoServicio.value = "";
            optvacioproductoServicio.selected = true;
            optvacioproductoServicio.disabled = true;

            //Primera opcion del select vacio y que no deje seleccionar
            select_productoServicio.appendChild(optvacioproductoServicio);

            // Ordenar filas filtradas de manera ascendente
            data.sort(function (a, b) {
                return a[1].toString().localeCompare(b[1].toString());
            });

            // Agregar opciones filtradas al select
            for (var j = 0; j < data.length; j++) {
                if (data[j][0] == "select_productoServicio") {
                    var option = document.createElement("option");
                    option.value = data[j][1]; // Valor de la columna B
                    option.text = data[j][1]; // Texto de la columna B
                    select_productoServicio.appendChild(option);
                }
            }// fin for

        }// rpt_Cargarselect

        function antesdeAgregarAbiertoCerrado() {

            var btnGuardarPiezas = document.getElementById('btnGuardarPiezas');
            btnGuardarPiezas.disabled = true;


            google.script.run
                .withSuccessHandler(rpt_antesdeAgregarAbiertoCerrado)
                .withFailureHandler(muestraErrorProceso)
                .gsantesdeAgregarAbiertoCerrado();


        }// fin de concursos abierto o cerrado

        function rpt_antesdeAgregarAbiertoCerrado(valorCelda) {


            if (valorCelda == 0) {

                alerConcursoCerrado();
                cerrarMyModalVentas();

                btnGuardarPiezas.disabled = false;
                return;
            } else {// Concurso abierto

                const txtMatricula = document.getElementById("txtMatricula").value;
                const txtVehiculo = document.getElementById("txtVehiculo").value; 
                const txtModelo = document.getElementById("txtModelo").value;
                const txtAnio = document.getElementById("txtAnio").value;
                const txtColor = document.getElementById("txtColor").value;
                const numberPiezas = document.getElementById("numberPiezas").value;
                const select_productoServicio = document.getElementById("select_productoServicio").value;

                if (!txtMatricula || !txtVehiculo ||  !txtModelo || !txtAnio || !txtColor || !numberPiezas ||!select_productoServicio) {
                    console.log("Debes completar todos los campos.");

                    Swal.fire({
                        icon: 'warning',
                        title: 'Debes completar todos los campos.',
                        text: 'No se puede guardar la entrada. Intentalo de nuevo',
                        //footer: '<a href="">Why do I have this issue?</a>'
                    })
                    btnGuardarPiezas.disabled = false;
                    return;
                } else {

                    //console.log("Todos los campos están completos.");
                    // Aquí puedes realizar otras acciones si todos los campos están completos.
                    validaAgregarEditar();

                }


            } // fin del else


        }// Fin rpt_concursoAbiertoCerrado

        // Función para verificar si el modal myModalVentas está abierto
        function isMyModalVentasOpen() {
            const myModalVentas = document.getElementById("myModalVentas");
            return myModalVentas.classList.contains("show");
        }

        // Función para cerrar el modal myModalVentas
        function cerrarMyModalVentas() {
            const myModalVentas = document.getElementById("myModalVentas");
            if (isMyModalVentasOpen()) {
                $(myModalVentas).modal('hide') //  un modal Cierra modal
            }
        }


        function abrirmodalVenta() {
            limparControles();
            cargarselect();

        }


        function validaAgregarEditar() {



            // Codigo Vacio Agrega nuevo empleaado
            if (document.getElementById('txtkey').value == '') {

                //alert('Agrega');

                agregarPiezas();

            } else {// Edita Venta

                //alert('Edita');
                editarPiezas();

            }

        }// Valida Editar o Agregar


        function agregarPiezas() {

            var fechaActual = new Date();
            var anio = fechaActual.getFullYear(); // Obtener el año actual
            var mes = fechaActual.getMonth() + 1; // Obtener el mes actual (sumando 1)
            var dia = fechaActual.getDate();
            var hora = fechaActual.getHours(); // Obtener la hora actual
            var minutos = fechaActual.getMinutes(); // Obtener los minutos actuales
            var seg = fechaActual.getSeconds();
            var fechaRegistro = new Date().toLocaleDateString();
            var horaRegistro = new Date().toLocaleTimeString();



            var txt_usuario = document.getElementById('txt_usuario').value;
            var txt_nombreSesion = document.getElementById('txt_nombreSesion').value;
            var txtMatricula = document.getElementById('txtMatricula').value;
            var txtVehiculo = document.getElementById('txtVehiculo').value;
            var txtModelo = document.getElementById('txtModelo').value;
            var txtAnio = document.getElementById('txtAnio').value;
            var txtColor = document.getElementById('txtColor').value;
            var select_productoServicio = document.getElementById('select_productoServicio').value;
            var numberPiezas = document.getElementById('numberPiezas').value;


            // Generacion de Key autogenerico
            var cod0 = txt_usuario[0] + txt_usuario[txt_usuario.length - 1];
            var cod1 = txtMatricula[0] + txtMatricula[txtMatricula.length - 1];
            var cod2 = txtVehiculo[0] + txtVehiculo[txtVehiculo.length - 1];
            var cod3 = select_productoServicio[0] + select_productoServicio[select_productoServicio.length - 1];

            var codigogenerado = cod0 + cod1 + cod2 + cod3 + numberPiezas + '-' + anio + mes + dia + hora + minutos + seg;
            var key = codigogenerado.replace(/\s+/g, '');//Eliminia los espacios en blanco dentro y fuera de la cadena
            //fin de key autogenerico
            //alert(key);

            var btnCerrarModal = document.getElementById('btnCerrarModal');
            btnCerrarModal.disabled = true;

            // var btnGuardarPiezas=document.getElementById('btnGuardarPiezas');
            //btnGuardarPiezas.disabled=true;

            var datos = [key, fechaRegistro, horaRegistro, txt_usuario, txt_nombreSesion, txtMatricula, txtVehiculo, txtModelo, txtAnio, txtColor.toUpperCase(), select_productoServicio, numberPiezas];


            google.script.run
                .withSuccessHandler(rpt_agregarVenta)
                .withFailureHandler(muestraErrorProceso)
                .gsAgregarVentar(datos);



        } // empleadoAgregar

        function rpt_agregarVenta() {


            document.getElementById('txtMatricula').value = "";
            document.getElementById('txtVehiculo').value = "";
            document.getElementById('txtModelo').value = "";
            document.getElementById('txtAnio').value = "";
            document.getElementById('txtColor').value = "";
            document.getElementById('select_productoServicio').value = "";
            document.getElementById('numberPiezas').value = "";
            document.getElementById('txtMatricula').focus();

            var btnCerrarModal = document.getElementById('btnCerrarModal');
            btnCerrarModal.disabled = false;

            var btnGuardarPiezas = document.getElementById('btnGuardarPiezas');
            btnGuardarPiezas.disabled = false;

            alertGuardado();


        }// fin rpt_EmpleadoAgregar


        function listaVentas() {

            var divcargandoconsulta = document.getElementById('divcargandoconsulta');
            divcargandoconsulta.style.display = '';

            //var div_datatable = document.getElementById('div_datatable');
            //div_datatable.style.display = 'none';

            var div_datatable = document.getElementById('div_datatable');
            div_datatable.style.visibility = 'hidden';

            var txt_usuario = document.getElementById('txt_usuario').value
            var rol = document.querySelector('input[name="rol"]:checked').value;

            google.script.run
                .withSuccessHandler(rpt_listaVentas)
                .withFailureHandler(muestraErrorProceso)
                .gslistaVentas(rol, txt_usuario);

        }// fin lista Ventas


        function rpt_listaVentas(registros) {

            $('#registrosTable').DataTable({
                columnDefs: [
                    { targets: 0, width: '10%' }, // Asignar un ancho de 200px a la primera columna
                    { targets: 1, width: '10%' }
                ],
                destroy: true,
                lengthMenu: [
                    [10, 25, 50, -1],
                    [10, 25, 50, 'All'],
                ],
                "pageLength": 10,
                data: registros,
                columns: [

                    {
                        data: 0, title: 'Acciones',
                        render: function (registros, type, row) {
                            // Aquí puedes generar el HTML del botón utilizando los valores de la fila actual
                            return '<button class="btn btn-outline-primary" data-toggle="modal" data-target="#myModalVentas" style="width:45%;border: none" data-id="' + row[0] + '" onclick=cargarVentasmodal("' + row[0] + '")  ><i class="fas fa-edit"></i></button> <button class="btn btn-outline-danger" style="width:45%;border: none" data-id="' + row[0] + '" onclick=eliminarVenta("' + row[0] + '") ><i class="fas fa-trash"></i></button>';
                        }
                    },
                    { data: 0, title: 'Key' },
                    { data: 1, title: 'Fecha' },
                    { data: 2, title: 'Hora' },
                    { data: 3, title: 'Usuario' },
                    { data: 4, title: 'Nombre Usuario' },
                    { data: 5, title: 'Matrícula' },
                    { data: 6, title: 'Vehículo' },
                    { data: 7, title: 'Modelo' },
                    { data: 8, title: 'Año' },
                    { data: 9, title: 'Color' },
                    { data: 10, title: 'Compañía' },
                    { data: 11, title: 'Piezas' }
                ],
                // Otras opciones de configuración
                responsive: true,
                "language": {
                    "lengthMenu": "Mostrar _MENU_",
                    "zeroRecords": "Nada encontrado - disculpa",
                    "info": "Pagina _PAGE_ de _PAGES_",
                    "infoEmpty": "No hay registros disponibles",
                    "infoFiltered": "(Filtrado de _MAX_ registros totales)",
                    "search": "Filtrar"
                }
            });

            var divcargandoconsulta = document.getElementById('divcargandoconsulta');
            divcargandoconsulta.style.display = 'none';

            //var div_datatable = document.getElementById('div_datatable');
            //div_datatable.style.display = '';
            var div_datatable = document.getElementById('div_datatable');
            div_datatable.style.visibility = 'visible';

            div_datatable.style.removeProperty("visibility");

            var div_datatable = document.getElementById('div_datatable');
            div_datatable.style.display = ''




        }// Rpt_listaventas


        function eliminarVenta(variable) {

            google.script.run
                .withSuccessHandler(rpt_antesdeEliminarVenta)
                .withFailureHandler(muestraErrorProceso)
                .gs_antesdeEliminarVenta(variable);


            /*Swal.fire({
            title: 'Deseas eliminar este registro?',
            text: "Estas seguro?'",
            icon: 'error',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, Eliminarlo!'
              }).then((result) => {
                if (result.isConfirmed) {
                   google.script.run
                  .withSuccessHandler( rpt_EliminarVenta )
                  .withFailureHandler ( muestraErrorProceso )
                  .gs_EliminarVenta(variable);
                
                  Swal.fire(
                    'Eliminado!',
                    'El registro ha sido Eliminado.',
                    'success'
                  )
                }
              })*/

        }

        function rpt_antesdeEliminarVenta(variable) {

            if(variable==0) {//cero concurso cerrado

                alerConcursoCerrado();
                return;

            } else {

                Swal.fire({
                    position: 'top',
                    title: 'Deseas eliminar este registro?',
                    text: "Estas seguro?'",
                    icon: 'error',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, Eliminarlo!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        google.script.run
                            .withSuccessHandler(rpt_EliminarVenta)
                            .withFailureHandler(muestraErrorProceso)
                            .gs_EliminarVenta(variable);

                        Swal.fire(
                            {
                                position: 'top',
                                title: 'Eliminado!',
                                text: 'El registro ha sido Eliminado.',
                                icon: 'success'
                            }
                        )
                    }
                })

            }

        }// fin rpt_gs_antesdeEliminarVenta   

        function rpt_EliminarVenta(resultado) {

            console.log(resultado);
            listaVentas();

        }// fin rpt_EliminarEmpleado


        function cargarVentasmodal(index) {

            //alert(index);
            limparControles();
            cargarselect();
            alertcargandoEdit();

            /*
             google.script.run
            .withSuccessHandler( rpt_cargarVentasmodal )
            .withFailureHandler ( muestraErrorProceso )
            .gsbuscarRegistro(index)*/

            setTimeout(function () {
                google.script.run
                    .withSuccessHandler(rpt_cargarVentasmodal)
                    .withFailureHandler(muestraErrorProceso)
                    .gsbuscarRegistro(index);
            }, 3000); // Pausa de 3 segundos antes de ejecutar la busqueda de registro para que pueda cargar el select con todos los registros

        }// cargarVentasomodal

        function rpt_cargarVentasmodal(registroventa) {

            //alert(registroventa);
            document.getElementById('txtkey').value = registroventa[0];
            document.getElementById('txtMatricula').value = registroventa[1];
            document.getElementById('txtVehiculo').value = registroventa[2];
            document.getElementById('txtModelo').value = registroventa[3];
            document.getElementById('txtAnio').value = registroventa[4];
            document.getElementById('txtColor').value = registroventa[5];
            document.getElementById('select_productoServicio').value = registroventa[6];
            document.getElementById('numberPiezas').value = registroventa[7];


        }// cargarVentasomodal

        function editarPiezas() {


            var txtkey = document.getElementById('txtkey').value;
            //var txt_usuario= document.getElementById('txt_usuario').value;
            var txtMatricula = document.getElementById('txtMatricula').value;
            var txtVehiculo = document.getElementById('txtVehiculo').value;
            var txtModelo= document.getElementById('txtModelo').value;
            var txtAnio = document.getElementById('txtAnio').value;
            var txtColor = document.getElementById('txtColor').value;
            var select_productoServicio = document.getElementById('select_productoServicio').value;
            var numberPiezas = document.getElementById('numberPiezas').value;

            var btnCerrarModal = document.getElementById('btnCerrarModal');
            btnCerrarModal.disabled = true;

            //var btnGuardarPiezas=document.getElementById('btnGuardarPiezas');
            //btnGuardarPiezas.disabled=true;

            //var datos=[txtkey,txtMatricula,txtVehiculo,txtModelo,txtAnio,txtColor,select_productoServicio,numberPiezas];

            google.script.run
                .withSuccessHandler(rpt_EditarVenta)
                .withFailureHandler(muestraErrorProceso)
                .gsEditarVentar(txtkey,txtMatricula,txtVehiculo,txtModelo,txtAnio,txtColor,select_productoServicio, numberPiezas);


        } // VentasEditar

        function rpt_EditarVenta() {

            var btnCerrarModal = document.getElementById('btnCerrarModal');
            btnCerrarModal.disabled = false;

            var btnGuardarPiezas = document.getElementById('btnGuardarPiezas');
            btnGuardarPiezas.disabled = false;
            limparControles();
            alertEditado();

        } // FIN rpt_EditarVenta

        function dashleerFechaHoravigencia() {

            google.script.run
                .withSuccessHandler(rpt_DashleerFechaHoravigencia)
                .withFailureHandler(muestraErrorProceso)
                .gsDashleerFechaHoravigencia();

        }// fin 

        function rpt_DashleerFechaHoravigencia(resultado) {

            citeFechahora = document.getElementById('citeFechahora');
            citeFechahora.textContent = resultado;

        }


        function dashrankingVentas() {


            var pprimer = document.getElementById('pprimer');
            var psegundo = document.getElementById('psegundo');
            var ptercero = document.getElementById('ptercero');
            var tbody = document.getElementById("tableRanking").getElementsByTagName("tbody")[0];


            pprimer.innerHTML = "";
            psegundo.innerHTML = "";
            ptercero.innerHTML = "";


            // Limpiar contenido previo de la tabla
            tbody.innerHTML = "";


            google.script.run
                .withSuccessHandler(rpt_dashrankingVentas)
                .withFailureHandler(muestraErrorProceso)
                .gsDashrankingVentas();

        }//dashrankingVentas

        function rpt_dashrankingVentas(resultado) {

            if (resultado.length === 0) {// Si el arreglo esta vacio

                // Se deha en blanco
                console.log('No hay ventas , arreglo vacio');

            } else {// Contiene elementos

                var pprimer = document.getElementById('pprimer');
                var psegundo = document.getElementById('psegundo');
                var ptercero = document.getElementById('ptercero');

                pprimer.innerHTML = "1er Puesto - " + resultado[0][1];
                psegundo.innerHTML = "2do Puesto - " + resultado[1][1];
                ptercero.innerHTML = "3er Puesto - " + resultado[2][1];


                var tbody = document.getElementById("tableRanking").getElementsByTagName("tbody")[0];

                // Limpiar contenido previo de la tabla
                tbody.innerHTML = "";

                // Crear filas y columnas de la tabla
                for (var i = 0; i < resultado.length; i++) {
                    var fila = tbody.insertRow();

                    for (var j = 0; j < resultado[i].length; j++) {
                        var celda = fila.insertCell();
                        celda.innerHTML = resultado[i][j];
                    }
                }

            }// Fin del If 

        }// rpt_dashrankingVentas




        function dashtotales() {

            var h4obejtivos = document.getElementById('h4obejtivos');
            var h4ventas = document.getElementById('h4ventas');
            var h4gap = document.getElementById('h4gap');
            var progressAvance = document.getElementById('progressAvance');
            var h5avance = document.getElementById('h5avance');

            h4obejtivos.innerHTML = "";
            h4ventas.innerHTML = "";
            h4gap.innerHTML = "";
            h5avance.innerHTML = "";
            progressAvance.style.width = '1%';

            google.script.run
                .withSuccessHandler(rpt_dastotales)
                .withFailureHandler(muestraErrorProceso)
                .gsDashtotales();


        }// dashtotales


        function rpt_dastotales(resultados) {

            if (resultados.length === 0) {// Si el arreglo esta vacio

                console.log("Arreglo vacio");

            } else {// si el arreglo tiene valores

                var h4obejtivos = document.getElementById('h4obejtivos');
                var h4ventas = document.getElementById('h4ventas');
                var h4gap = document.getElementById('h4gap');
                var progressAvance = document.getElementById('progressAvance');
                var h5avance = document.getElementById('h5avance');


                h4obejtivos.innerHTML = resultados[0];
                h4ventas.innerHTML = resultados[1];


                if (resultados[2] >= 0) {
                    h4gap.innerHTML = resultados[2] + '🏆';
                } else {

                    h4gap.innerHTML = resultados[2];
                }

                progressAvance.style.width = resultados[3] + '%';

                if (resultados[3] >= 100) {

                    h5avance.innerHTML = "¡Objetivo Cumplido! 🏆";
                } else {

                    h5avance.innerHTML = resultados[3].toFixed(1) + '% de Avance';
                }

            }

        }// fin rpt_dastotales

        function dashBtnActualizar() {

            var btnDashActualizar = document.getElementById('btnDashActualizar');
            btnDashActualizar.disabled = true;

            leerAbrircerrarConcurso();
            leerFechaHora();
            configobtenerFilas();
            cargarselect();
            dashleerFechaHoravigencia();
            dashrankingVentas();
            dashtotales();


            btnDashActualizar.disabled = false;

        }// Fin dashBtnActualizar

        function limparControles() {

            document.getElementById('txtkey').value = '';
            document.getElementById('txtMatricula').value = '';
            document.getElementById('txtVehiculo').value = '';
            document.getElementById('txtModelo').value = '';
            document.getElementById('txtAnio').value = '';
            document.getElementById('txtColor').value = '';
            document.getElementById('select_productoServicio').value = '';
            document.getElementById('numberPiezas').value = '';
            document.getElementById('txtMatricula').focus();


        }// fin limpiar COntroles





        function exportarTablaAExcel() {
            // Obtener la tabla por su ID
            var tabla = document.getElementById('registrosTable');

            // Crear un nuevo libro de Excel
            var libro = XLSX.utils.book_new();

            // Crear una hoja de cálculo
            var hoja = XLSX.utils.table_to_sheet(tabla);

            // Agregar la hoja al libro
            XLSX.utils.book_append_sheet(libro, hoja, 'Hoja 1');

            // Guardar el libro como archivo de Excel
            XLSX.writeFile(libro, 'Taller' + '.xlsx');
        }


        function muestraError() {

            alertErrorSesion();

        }

        function muestraErrorProceso() {

            alertError();

        }

        function alertcargando() {

            let timerInterval
            Swal.fire({
                position: 'top',
                title: 'Despierta tu potencial.</br>¡Estamos Listos! ',
                html: '</br><i class="fas fa-trophy winner-icon-cargando fa-3x mr-3" id="logo" aria-hidden="true"></i>',
                timer: 4500,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading()
                    timerInterval = setInterval(() => {
                        const content = Swal.getHtmlContainer()
                        if (content) {
                            const b = content.querySelector('b')
                            if (b) {
                                b.textContent = Swal.getTimerLeft()
                            }
                        }
                    }, 100)
                },
                willClose: () => {
                    clearInterval(timerInterval)
                }
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log('I was closed by the timer')
                }
            })
        } // fin alertcargando



        function alertErrorSesion() {

            Swal.fire({
                position: 'top',
                icon: 'error',
                title: 'Oops...',
                text: 'Usuario , contraseña ó rol incorrectos',
                //footer: '<a href="">Why do I have this issue?</a>'
            })

        }// alertErrorSesion


        function alertRegistro() {

            Swal.fire({
                //position: 'top-end',
                position: 'top',
                icon: 'success',
                title: 'Se registro Correctamente',
                showConfirmButton: true
                //timer: 7000
            })

        }// fin alert

        function alertError() {

            Swal.fire({
                position: 'top',
                icon: 'error',
                title: 'Oops...',
                text: 'Surgio un error',
                //footer: '<a href="">Why do I have this issue?</a>'
            })

        }// alertErrorSesion

        function alerConcursoCerrado() {

            Swal.fire({
                position: 'top',
                icon: 'error',
                title: 'No se puede agregar,editar ni eliminar ventas...',
                text: 'Concurso Cerrado',
                //footer: '<a href="">Why do I have this issue?</a>'
            })

        }// alertErrorSesion


        function alertGuardado() {

            Swal.fire({
                //position: 'top-end',
                position: 'top',
                icon: 'success',
                title: 'Registro guardado',
                showConfirmButton: true
                //timer: 7000
            })

        }// fin alert


        function alertEditado() {

            Swal.fire({
                //position: 'top-end',
                position: 'top',
                icon: 'success',
                title: 'Registro actualizado exitosamente',
                showConfirmButton: true
                //timer: 7000
            })

        }// fin alert


        function alertcargandoEdit() {

            let timerInterval
            Swal.fire({
                position: 'top',
                title: 'Cargando Datos',
                html: 'Espere por favor <b></b> milisegundos.',
                timer: 3500,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading()
                    timerInterval = setInterval(() => {
                        const content = Swal.getHtmlContainer()
                        if (content) {
                            const b = content.querySelector('b')
                            if (b) {
                                b.textContent = Swal.getTimerLeft()
                            }
                        }
                    }, 100)
                },
                willClose: () => {
                    clearInterval(timerInterval)
                }
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log('I was closed by the timer')
                }
            })
        } // fin alertcargando




  </script>



  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS  -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
  </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
  </script>


  <!-- Datatable  -->



  <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.3.0/js/responsive.bootstrap4.min.js"></script>

  <!-- SWEET ALERT   2-->
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- LIBRERIA PARA EXPORAR A EXCEL CON JAVASCRIPT   -->
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>


</body>

</html>
